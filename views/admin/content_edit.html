{% extends 'layout.html' %}

{%block main%}
<script type="text/javascript" charset="utf-8" src="/public/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="/public/ueditor/ueditor.all.js"> </script>
<script type="text/javascript" charset="utf-8" src="/public/ueditor/lang/zh-cn/zh-cn.js"></script>
<ol class="breadcrumb">
    <li><a href="/admin/content">文章列表</a></li>
    <li><span>编辑文章</span></li>
</ol>
<h3>编辑文章</h3>
<!--<form role="form" method="post" id="form" >-->
    <div class="form-group">
        <input type="hidden" class="form-control contentTitle" id="id" placeholder="请输入文章标题" name="id" value="{{id}}">
    </div>
    <div class="form-group">
        <label for="title">文章分类:</label>
        <input type="text" class="form-control" id="category" placeholder="请输入文章标题" name="category" value="{{categoriyName}}">
    </div>
    <div class="form-group">
        <label for="title">文章标题:</label>
        <input type="text" class="form-control" id="title" placeholder="请输入文章标题" name="title" value="{{contents.title}}">
    </div>
    <div class="form-group">
        <label for="description">内容简介:</label>
        <textarea name="description" id="description" class="form-control" cols="30" rows="5" placeholder="请输入内容简介">{{contents.description}}</textarea>
    </div>
    <div class="form-group">
        <label for="content">文章内容:</label>
        <!--<textarea name="content" id="content" class="form-control" cols="30" rows="5" placeholder="请输入文章内容">{{contents.content}}</textarea>-->
        <script id="editor" type="text/plain" style="width:100%;height:500px;">{{contents.content}}</script>
    </div>
    <button type="submit" class="btn btn-default">提交</button>
<!--</form>-->
<script>
    $(function(){
        var ue = UE.getEditor('editor');
//        var editor = new baidu.editor.ui.Editor();
//        editor.render("editor");
//        UE.getEditor('editor').execCommand('insertHtml', value);
        $(".btn-default").on("click",function(){
            console.log($(window.frames[1].document.getElementsByClassName("view")[0]).find(".view").html())
            $.ajax({
                type:"post",
                url:"/api/content/edit",
                data:{
                    id: $(".contentTitle").val(),
                    category:$('#category option:selected').val(),
                    title:$("#title").val(),
                    description:$("#description").val(),
                    contents:$(window.frames[1].document.getElementsByClassName("view")[0]).find(".view").html()
                },
                success:function(data){
                    if(data.code == 37){
                        window.location.href = "/admin/content"
                    }
                }
            })
        })
    })
</script>
{%endblock%}